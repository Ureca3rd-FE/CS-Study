# 경쟁 상태 (Race Condition)

[경쟁 상태(Race Condition) | 👨🏻‍💻 Tech Interview](https://gyoogle.dev/blog/computer-science/operating-system/Race%20Condition.html)

**<목차>**

---

# **경쟁 상태 (Race Condition)**

<aside>
💡

공유 자원에 대해 여러 프로세스가 동시에 접근을 시도할 때, 타이밍이나 순서 등이 결과값에 영향을 줄 수 있는 상태

 **= 두 개의 스레드가 하나의 자원을 놓고 서로 사용하려고 경쟁**하는 상황

</aside>

여러 프로세스가 동시에 접근할 때, **자료의 일관성을 해치는 결과**가 나타날 수 있음…

## 경쟁 상태가 발생하는 경우

**1. 커널 작업을 수행하는 중에 인터럽트 발생**

- 발생
    
     : 커널모드에서 데이터를 로드하여 작업 수행 중 인터럽트가 발생하여 같은 데이터를 조작하는 경우
    
- 해결
    
     : 커널모드에서 작업을 수행하는 동안 인터럽트를 disable 시켜 CPU 제어권을 가져가지 못하게 하기
    

**2. 프로세스가 'System Call'을 하여 커널 모드로 진입하여 작업을 수행하는 도중, 문맥 교환이 발생할 때**

- 발생
    
     : 프로세스1이 커널모드에서 데이터를 조작하는 도중, 시간이 초과되어 CPU 제어권이 프로세스2로 넘어가 같은 데이터를 조작하는 경우 ( 프로세스2가 작업에 반영되지 않음 )
    
- 해결
    
     : 프로세스가 커널모드에서 작업을 하는 경우 시간이 초과되어도 CPU 제어권이 다른 프로세스에게 넘어가지 않도록 함
    

**3. 멀티 프로세서 환경에서 공유 메모리 내의 커널 데이터에 접근할 때**

- 발생
    
     : 멀티 프로세서 환경에서 2개의 CPU가 동시에 커널 내부의 공유 데이터에 접근하여 조작하는 경우
    
- 해결
    
     : 커널 내부에 있는 각 공유 데이터에 접근할 때마다, 그 데이터에 대한 lock/unlock을 하는 방법
    

# **임계 영역 (Critical Section)**

<aside>
💡

운영체제에서 여러 프로세스가 데이터를 공유하면서 수행될 때, **각 프로세스에서 공유 자원에 접근하는 프로그램 코드**

프로세스 간에 공유 자원을 접근하는 것에 있어 문제가 발생하지 않도록 **공유 자원의 독점을 보장**해주는 영역

</aside>

## 임계 영역 해결 조건

임계 영역 문제를 해결하기 위해서는 아래의 3가지 조건을 충족해야 함

**1. Mutual Exclusion (상호 배제)**

 : 한 프로세스가 자신의 임계 영역이면, 다른 프로세스들은 임계 영역에 진입 불가능

**2. Progress (진행)**

아무도 임계 영역에 있지 않다면, 진입하고자 하는 프로세스를 진입하게 해줘야 함

 → **임계 영역에 아무도 진입하지 못하고 있으면 안되며**, 다음에 어떤 프로세스가 임계 영역에 진입해야 하는지 일정 시간 내에 결정되어야 함!

**3. Bounded Waiting (유한 대기)**

 : 프로세스가 임계 영역에 진입하기 위해 무한정으로 기다리는 현상(Starvation)이 발생해서는 안됨

## **임계 영역 해결 방법**

### **유저모드의 동기화**

> 커널의 힘을 빌리지 않는(= 커널 코드가 실행되지 않는) 동기화 기법
> 

  ex) 피터슨 알고리즘

### 커널모드의 동기화

> 커널에서 제공하는 동기화 기능을 활용하는 방법
> 

 커널 모드로의 변경이 필요 → 성능 저하가 일어나지만 다양한 기능 활용 가능

ex) 세마포어, 뮤텍스, 모니터

---

*참고 자료*

[[운영체제] 경쟁 상태 (Race Condition)](https://velog.io/@klloo/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B2%BD%EC%9F%81-%EC%83%81%ED%83%9C-Race-Condition)

[경쟁상태(Race Condition)](https://rnrwk0502.tistory.com/17)

[[운영체제] 경쟁 조건(Race Condition)과 임계 구역(Critical Section) — 밝은별 개발 블로그](https://brightstarit.tistory.com/10)