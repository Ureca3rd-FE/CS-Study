# IPC (Inter Process Communication)

[IPC(Inter Process Communication) | 👨🏻‍💻 Tech Interview](https://gyoogle.dev/blog/computer-science/operating-system/IPC.html)

**<목차>**

---

# **IPC (Inter Process Communication)**

![image.png](assets/image.png)

<aside>
💡

하나의 컴퓨터 안에서 실행되는, **프로세스 간에 발생하는 통신**

= 프로세스가 다른 프로세스와 협력(통신)하는 방법

</aside>

프로세스는 시스템 안에서 서로 독립적인 주소 공간을 가지며 실행… (서로 영향 X)

프로세스간 통신을 하려면? → IPC 사용!

프로세스는 **_커널_**이 제공하는 IPC 설비를 사용하여 서로 간의 통신이 가능

_(커널이란? 운영체제의 핵심적인 부분으로, 다른 모든 부분에 여러 기본적인 서비스를 제공해주는 것)_

# **IPC가 필요한 이유**

> 프로세스 간 통신이 왜 필요할까?

**1. 정보 공유(Information Sharing)**

사용자마다 동일한 정보에 액세스해야 할 경우에 필요

**2. 가속화(Computation Speed-up)**

특정 작업(task)을 여러 개의 서브 작업(sub task)로 쪼개어 프로세스의 병렬성 증가 = 처리 속도⬆️

(이렇게 쪼개진 작업들은 서로 간의 통신 필요)

**3. 모듈화(Modularity)**

특정 시스템 기능을 별도의 프로세스(스레드)로 구분하여 모듈화된 시스템 구성 가능,

이때 모듈 간의 통신을 위해 IPC가 필요

**4. 편의성(Convenience)**

다수의 사용자가 여러 작업을 동시에 수행 가능

# **IPC 종류**

## 1. **shared memory**

> 공유 메모리를 이용해서 데이터를 주고 받는 방법 → 프로세스간 메모리 영역을 공유

![image.png](assets/image%201.png)

- **특징** : 프로세스들이 공유 메모리 영역을 구축하고, 해당 영역에서 데이터나 자원을 공유
- **장점**
  - 커널 의존성이 낮기 때문에 속도가 빠름 (커널을 거치지 않아 오버헤드 X)
  - 유저 레벨에서 IPC가 가능 → 통신이 자유로움
  - 많은 양의 데이터를 주고받을 때 효율적
- **단점**
  - 여러 프로세스가 자원과 데이터를 공유 → 동기화 이슈가 발생
    ex) 두 프로세스가 동시에 같은 위치에 쓰면 데이터가 꼬일 수 있음

**공유 메모리 구조 (세그먼트)**

- 공유 메모리는 **각 프로세스의 힙과 스택 사이**에 위치
- 공유 메모리를 생성하는 프로세스의 메모리 공간에 위치
- 한 프로세스가 공유 메모리를 제작 → 다른 프로세스는 **해당 메모리를 자기 주소공간에 연결**하여 사용

**프로세스 사이의 공유 메모리 사용 조건**

- **메모리 보호 제한 해제** → 다른 프로세스도 접근할 수 있게 해야 함
- 동일한 위치를 동시에 수정하지 않도록 **동기화** 필요
- 공유 메모리를 버퍼처럼 활용 (한쪽이 쓰고, 한쪽이 읽는 방식)

**공유 메모리 생성**

모든 프로세스가 같은 키(key)를 알고 있으며, 해당 키(key)를 기준으로 공유 메모리가 생성되는 방식

→ 프로세스들은 이렇게 생성된 공유 메모리 공간에 데이터를 저장하거나 읽음

### 메모리 맵(Memory Map)

> **열린 파일을 메모리에 맵핑시켜서 공유**하는 방식 (공유 매개체가 파일+메모리)

대용량 데이터를 공유해야 할 때 사용

## **2. message passing**

> 프로세스들이 메모리를 직접 공유하지 않고, 운영체제가 중간에서 메시지를 전달해주는 통신 방법

![image.png](assets/image%202.png)

- **특징**
  - 프로세스가 자원을 직접 공유하지 않은 채로 통신하고, 운영체제가 통신과 동기화의 메커니즘 제공
  - 구현이 간단하고 적은 양의 데이터 전달에 적합한 방법
- **장점**
  - 커널을 사용하여 다른 것을 구축할 필요 X → 구현이 쉬움
  - **커널이 통제 →** 안정적 (프로세스가 메모리를 직접 건드리지 않음)
  - 동기화 문제를 신경 쓸 필요 X
- **단점**
  - 커널을 이용하기 때문에 시스템 콜(System call) 필수 → 오버헤드 발생 가능성
  - 커널을 거치면서 **데이터 복사(두 번)가 발생 → 느려짐 (매번 시스템 호출 사용)**
  - 메모리 크기의 제한 (해당 채널 크기 이상은 전송 불가)
- **종류** : 파이프, 시그널, 메시지 큐, 소켓 등

**메시지 전달의 기본 연산**

- **send(message)** : 메시지 발신
- **receive(message)** : 메시지 수신
- **channel** : 메시지가 오가는 통로

**send/receive 연산 수행 방법**

- 직접 / 간접 통신
- 동기식 / 비동기식 통신
- 자동 / 명시적 버퍼링

### 메시지 전달 모델 ① - **파이프 (Pipe)**

> 하나의 프로세스가 다른 프로세스에게 **직접 데이터를 전달하는 방식**

![image.png](assets/image%203.png)

파이프는 두개의 프로세스를 연결…

→ 하나의 프로세스는 데이터를 쓰기만 하고, 다른 하나는 데이터를 읽기만 가능 (읽기/쓰기 동시에 불가능)

**1) 익명 PIPE**

통신할 프로세스를 명확히 알 수 있는 경우에 사용

ex) 부모 - 자식 간 프로세스…

**2) Named PIPE(FIFO)**

서로 무관한 프로세스끼리도 통신 가능

### 메시지 전달 모델 ② - **시그널 (Signal)**

> 특정 프로세스에게 **이벤트**를 알리는 메시지

**특징**

- **프로세스 ID(PID)** 를 통해 특정 프로세스에게 메시지 전달
- 시그널 ID에 따라 어떤 이벤트인지 식별 가능

### 메시지 전달 모델 ③ - **메시지 큐 (Message Queue)**

> 고정 크기의 메시지를 연결 리스트를 통해 통신하는 방식

![image.png](assets/image%204.png)

**특징**

- **FIFO(선입선출)** 구조로 메시지를 관리
- 메시지 단위의 통신이며, 메시지 큐 ID를 통해 통신
- 여러 개의 프로세스가 동시에 데이터 접근 가능

### 메시지 전달 모델 ④ - **소켓 (Socket)**

> 네트워크 상에서 프로세스 간에 통신하는 방식

![image.png](assets/image%205.png)

**특징**

- 다른 컴퓨터끼리도 통신 가능
- Local 뿐만 아니라, 인터넷을 통한 Remote(원격) 통신도 가능
- 클라이언트-서버 구조로 주로 사용

## **3. Semaphore**

> 여러 프로세스가 동시에 같은 자원(메모리, 파일 등)에 접근하지 못하도록 관리하는 기술
>
> → 한번에 하나의 프로세스만 접근 가능하도록 관리

_세마포어 : 현재 자원에 접근 가능한 프로세스의 개수_

**특징**

- 공유 리소스에 접근할 수 있는 최대 허용치만큼 동시 사용자 접근을 할 수 있게 하는 기술
- 동기화 대상이 여러 개일 경우 사용

**세마포어를 통한 리소스 공유 메커니즘**

![image.png](assets/image%206.png)

N개의 테스크와 M개의 리소스 공유 시, 세마포어 초기값 = N

**리소스 공유 절차**

![image.png](assets/image%207.png)

테스크가 세마포어를 획득해도 뮤텍스를 획득해야 리소스 접근 가능

**세마포어를 통한 테스크 간 동기화 방법**

![image.png](assets/image%208.png)

1. Task A가 동기화 전처리 시작
2. Task B는 동기화 세마포어가 POST 시그널을 줄 때까지 wait
3. Task A가 동기화 전처리 완료
4. Task A, Task B 동기화 완료

- 테스크 간 동기화는 여러 테스크가 공유 자원에 접근할 경우 동일한 값을 얻을 수 있도록 조정(Sync)
- 계수형 세마포어의 경우 테스크A 전처리 결과에 따라 계수 증가, 테스크는 누적된 계수만큼 처리

---

_참고 자료_

[IPC(Inter-Process Communication)란?](https://y-oni.tistory.com/77)

[[OS] 프로세스 간 통신에 사용되는 IPC (Inter Process Communication)의 종류](https://rlaehddnd0422.tistory.com/241)

[[OS] 프로세스 간 통신(Inter-Process Communication,IPC)](https://junghyungil.tistory.com/146)
