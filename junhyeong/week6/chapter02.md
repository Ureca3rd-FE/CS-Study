# 🖲️운영체제 6주차

## Chap12. 페이징과 세그먼테이션

### #1. 메모리 분할 방식

#### 개념

- 메모리에 여러 개의 프로세스를 어떻게 배치하고 할당할지 결정하는 구조
- 메모리 전체를 어떤 구조로 나눌지 결정하는 방식

#### 연속 메모리 할당 (Contiguous Memory Allocation)

- 개념 : 프로세스가 메모리 내에서 연속된 공간을 차지
- 종류

  1. **고정 분할 방식 (Fixed Partitioning)**

  - 개념
    - (부팅 시) 메모리를 미리 정해진 크기의 분할로 나눔
    - 각 분할에 프로세스 하나만 올림
  - 특징
    - 구조와 관리가 단순함
    - 내부 단편화 발생 : 프로세스 크기 < 분할된 크기 일 때 발생
    - 유연성 낮음 : 분할 보다 큰 프로세스는 적재 불가
    - 넓은 의미의 외부 단편화 발생 : 프로세스를 올리지 못하는 블록들이 많아지는 경우

  2. **가변 분할 방식 (Variable Partitioning)**

  - 개념
    - 프로세스가 필요로 하는 크기 만큼 메모리 공간을 할당 (동적)
    - 분할의 크기와 개수가 실행 중 계속 변함
  - 특징
    - 내부 단편화 최소화 : 필요한 만큼만 할당
    - 외부 단편화 발생 : 프로세스 종료 시 발생하는 빈 공간을 재사용하기 어려움
    - 컴팩션(Compaction) 기법 사용 : 외부 단편화로 발생한 빈 공간을 한 곳에 모으는 과정

- 용어
  - **내부 단편화** : 프로세스가 요청한 크기보다 더 큰 메모리 블록이 할당되어, 사용되지 않는 일부 공간이 블록 내부에 남는 상태
  - **외부 단편화** : 메모리 전체적으로는 충분한 여유 공간이 있지만, 연속된 큰 블록이 존재하지 않아 프로세스를 적재할 수 없는 상태
  - **컴팩션** : 주 기억장치(메인 메모리)에서의 빈공간(외부 단편화)를 한쪽으로 몰아서 연속 공간을 만드는 과정
  - **조각 모음** : 보조 기억장치에서 파일들을 연속된 위치로 재배열하는 과정

#### 비연속 메모리 할당 (Non-contiguous Memort Allocation)

- 개념

  - 프로세스에 필요한 메모리를 여러 군데에 나누어 할당
  - 프로세스를 물리적으로 연속된 공간에 배치하지 않아도됨

- **페이징 (Paing)**
  - 개념
    - 프로세스와 물리 메모리를 고정 크기의 블록 단위로 나누어 관리하는 메모리 관리 기법
    - **메모리**를 일정한 크기의 **블록(프레임)** 으로 나눔
    - **프로세스**도 같은 크기의 **블록(페이지)** 으로 나누어 서로 다른 위치에 할당
  - 특징
    - 비연속 메모리 할당에서의 고정 분할 방식
    - 프로세스의 논리적 주소 공간을 페이지로, 물리적 메모리를 프레임으로 나누어 각각 대응
    - 외부 단편화가 없음
    - 내부 단편화 발생 : 페이지 크기 < 프레임 크기인 상황에서.
    - 가상 메모리 구현에 페이지 교체 알고리즘과 함께 사용됨
- **세그먼테이션 (Segmentation)**
  - 개념
    - 프로세스의 메모리를 **세그먼트**로 나누어 관리하는 메모리 관리 기법
    - 세그먼트는 메모리 내에서 연속적인 공간을 차지함
    - 세그먼트 : 프로세스를 논리적 단위(코드/데이터/스택 혹은 함수/데이터 등)으로 나눈 것
  - 특징
    - 비연속 메모리 할당에서의 가변 분할 방식
    - 내부 단편화는 거의 없음
    - 외부 단편화 발생 -> 컴팩션 필요
    - 세그먼트별로 공유 설정 및 보호가 가능

---

### #2. 메모리 관리 기법

#### 개념

- 메모리 자원을 효율적으로 사용하고, 프로세스가 원활하게 실행될 수 있도록 관리하는 일련의 방법

#### 페이징

- **단순 페이징 (Simple Paging)**

  - 개념
    - 프로세스의 메모리를 고정 크기 페이지 단위로 나누고
    - 물리 메모리도 같은 크기의 프레임 단위로 나누어 관리하는 기법
  - 특징
    - 모든 페이지가 메모리에 적재되어 있어야함 -> 메모리 용량에 제한 + 유연성 낮음
    - 외부 단편화 발생 X
    - 내부 단편화 발생 O

- **가상 메모리 페이징 (Virtual Memory Paging)**

  - 개념
    - 프로세스의 필요한 페이지에만 메모리를 할당하는 기법
    - 나머지 페이지는 스왑영역(보조기억장치)에서 필요할 때 불러들임(swap-in)
  - 특징
    - 물리 메모리가 부족해도 큰 프로그램 실행 가능
    - 외부 단편화 발생 X
    - 내부 단편화 발생 O
    - 메모리 관련 오버레이 증가 + 메모리 활용도 증가

- 용어
  - **오버레이**
    - 메모리 보다 큰 프로그램을 여러 조각으로 나누어, 필요한 부분만 올렸다가 내리는 방법
    - 가상 메모리 페이징과의 차이점
      - 오버레이 : 프로그래머의 주도. 수동으로 이뤄짐. (명시적으로 코드로 관리)
      - 가상 메모리 페이징 : 운영체제 주도. 자동으로 이뤄짐.
  - **스왑 영역 (swap area)** : 메모리에 올라간 일부의 프로세스를 제외한 나머지를 저장하는 보조기억장치의 공간
  - **스왑 아웃 (swap-out)** : 메모리 내 프로세스를 스왑영역으로 이동시키는 과정
  - **스왑 인 (swap-in)** : 스왑영역의 내용을 메모리로 불러오는 과정

#### 세그먼테이션

- **단순 세그먼테이션 (Simple Segmentation)**

  - 개념
    - 프로세스의 주소공간을 논리적 의미 단위인 세그먼트로 나눔
    - 세그먼트를 메모리의 연속된 공간에 적재하는 기법
    - 세그먼트의 크기는 가변적
  - 특징
    - 내부 단편화 발생 X
    - 외부 단편화 발생 O -> 빈공간이 충분함에도 연속된 공간이 없어 세그먼트 적재가 불가능한 상황
    - 모든 세그먼트가 메모리에 동시에 있어야 실행 가능 -> 메모리 부족 시 전체 프로세스를 교체(스왑인/스왑아웃)해야함

- **가상 메모리 세그먼테이션 (Virtual Memory Segmentation)**
  - 개념
    - 필요한 세그먼트만 선택적으로 메모리에 적재하는 방식
    - 나머지 세그먼트는 스왑영역에서 필요시 호출 가능
  - 특징
    - 내부 단편화 발생 X
    - 외부 단편화 발생 O -> 세그먼트를 페이지 단위로 쪼개어 관리하는 방식(페이징과 혼합하는 방식)으로 외부 단편화 줄이기 가능
    - 세그먼트 단위로 교체(스왑인/스왑아웃) 가능 -> 메모리 사용 효율 높음 + 큰 프로그램 실행 가능
