# 7주차 🛅데이터베이스

## Chap01. 키 (Key)

### #0. 용어

#### 각종 데이터 모델

- 계층형 데이터 모델

  - 부모-자식 관계인 형태로 표현
  - 트리 구조로 데이터가 조직되며 트리 구조를 따라 데이터 탐색이 이뤄짐

- 네트워크형 데이터 모델

  - 그래프 구조를 활용하여 노드간 다대다 관계도 표현이 가능한 모델
  - 계층형 모델의 한계를 극복
  - 구조가 복잡해질 수 있다는 단점

- 객체지향 데이터 모델

  - 데이터를 객체와 클래스 단위로 표현하는 모델
  - 객체의 속성(변수, 필드, 상태)과 행위(메서드)를 포함할 수 있어 현실세계를 자연스럽게 모델링 가능

- 관계 데이터 모델

  - 데이터를 2차원 테이블 형태인 릴레이션으로 표현하는 모델
  - 논리적 구조인 ER모델로 쉽게 변환이 가능함

- 문서 데이터 모델
  - JSON, BSON 같은 반정형 문서로 데이터를 저장
  - 주로 NoSQL에서 사용

#### 관계 데이터 모델에서의 용어

- 릴레이션(Relation)

  - 2차원 테이블
  - 행과 열로 정보를 표현.

- 속성(Attribute)

  - 릴레이션에서 열(Column)을 뜻함
  - 각각의 속성은 데이터의 특성을 나타냄

- 튜플(Tuple)

  - 릴레이션의 행(row)을 뜻함
  - 여러 속성들의 모임
  - 하나의 데이터 레코드를 의미

- 도메인(Domain)

  - 한 속성이 갖는 값들의 집합
  - 데이터 타입, 유효 범위를 정의함
  - 각 속성값은 도메인에 속한 원자값이어야함 (원자값: 더이상 분해될 수 없는 단일값)

- 차수(Degree)

  - 릴레이션 내 속성(열)의 개수
  - 유효한 릴레이션의 최소 차수는 1

- 카디널리티(Cardinality)

  - 릴레이션 내 튜플(행)의 개수
  - 유효한 릴레이션의 최소 카디날리티는 0

---

### #1. 키 (Key)

#### 개념

- 각 튜플을 유일하게 식별할 수 있는 하나 이상의 속성의 집합
- 특정 튜플(행)을 검색하거나 다른 튜플들과 연관시킬 수 있도록 하기 위함
- 키는 중복되는 값이 없어야함

#### 종류

1. 수퍼 키 (Super Key)

   - 개념: 튜플을 유일하게 식별할 수 있는 하나 이상의 속성의 집합
   - 특징
     - 유일성 충족 O
     - 최소성 충족 X -> 필요하지 않은 속성도 포함 가능
   - 예시
     - (주민등록번호, 이름)에서 이름은 필요하지 않음

2. 후보 키 (Candidate Key)

   - 개념: 각 튜플을 고유하게 식별하는 최소한의 속성들의 모임
   - 특징
     - 유일성/최소성 충족 O
     - 릴레이션에는 최소 1개의 후보키가 있음
     - 후보키는 1개 이상의 속성으로 구성됨
     - 후보키가 2개 이상의 속성으로 구성되어 있다면 복합키라고 부름
     - NOT NULL, UNIQUE 제약조건을 가짐
   - 예시
   - 테이블: 학생
   - 속성: 학번, 이름, 전화번호, 이메일, 전화번호
   - [학번], [전화번호], [이메일] 3가지 모두 후보 키 가능
   - [학번]을 기본키로 선정 시, [전화번호]와 [이메일]은 대체 키가 됨

3. 기본 키 (Primary Key)

   - 개념: 후보키 중에서 한개를 선택하여 튜플을 대표하는 키로 사용
   - 특징
     - 테이블 마다 하나의 기본키만 존재 가능
     - NULL값을 가지지 못함 (NOT NULL)
     - 유일해야 함 (UNIQUE)
     - 데이터 무결성을 보장
     - 인위적으로 생성한 대리 키=인공 키(Surrogate Key)가 기본키로 사용되기도 함 (원래 있는 키들은 자연 키라고 부름)

4. 대체 키 (Alternate Key)

   - 개념: 후보키 중 기본키로 선택되지 않은 나머지 키들

   - 특징
   - 기본 키가 손상되거나 사용할 수 없는 경우 대체 역할 수행
   - 여러개 존재 가능
   - NOT NULL, UNIQUE 제약조건을 가짐

5. 외래 키 (Foreign Key)

   - 개념: 한 릴레이션에서 다른 릴레이션의 기본키를 참조하는 속성
   - 특징
     - 외래키를 포함한 테이블을 자식 테이블, 참조되는 테이블을 부모 테이블이라고 부름
     - 외래 키의 속성은 참조되는 릴레이션의 기본 키와 동일한 도메인을 가져야 함
     - NULL값 가능 + 중복된 값 허용
       - 자식 테이블 내에서 가능하는 의미
       - 부모 테이블에서는 기본 키이므로 NULL값 불가능 + 중복된 값 허용 X
     - 참조 무결성 제약 조건: 부모 테이블의 기본키가 변경/삭제되면 외래키가 참조하는 값도 적절히 변경/삭제되어야 함
       - CASCADE: 부모 테이블에서 기본키를 변경/삭제 시, 자식 테이블의 외래 키를 가진 행들도 자동으로 변경/삭제
       - SET NULL: 부모 테이블에서 기본키를 변경/삭제 시, 자식 테이블의 외래 키 값을 NULL로 설정
       - NO ACTION (혹은 RESTRICT): 자식 테이블에서 참조 중일 시, 부모 테이블의 기본 키의 변경/삭제가 거부됨
       - 작성 위치
         ```sql
         ALTER TABLE 사원 ADD CONSTRAINT fk_부서번호
         FOREIGN KEY (부서번호) REFERENCES 부서(부서번호)
         ON DELETE <옵션자리>
         ON UPDATE <옵션자리>;
         ```
         - <옵션자리>에 위 세가지 옵션들 중 골라서 작성가능
         - 서로 변경/삭제에 서로 다른 옵션 지정 가능
   - 예시

     - 테이블: 사원, 부서
     - 사원 테이블의 속성: 사원번호[PK], 사원명, 부서번호
     - 부서 테이블의 속성: 부서번호[PK], 부서명, 인원수
     - 사원 테이블(자식 테이블)의 외래 키는 부서번호[FK]
     - 부서 테이블(부모 테이블)의 기본 키인 부서번호[PK]를 참조

     | 사원번호(PK) | 사원명 | 부서번호(FK) |
     | :----------: | :----: | :----------: |

     | 부서번호(PK) | 부서명 | 인원수 |
     | :----------: | :----: | :----: |

---

### 퀴즈

#### 1번. 차수와 카디날리티는 릴레이션(테이블)의 각각 어느부분의 개수를 지칭하는 걸 까요? (+ 최소 개수까지 맞춰보세요!)

- 차수: "열", "1"개
- 카디날리티: "행", "0"개

#### 2번. 수퍼 키, 후보 키, 기본 키, 대체 키를 포함 관계로 나타낼 시 옳은 것은?

1. 수퍼키 ( 후보키 ( 기본키
2. 기본키 ( 후보키 ( 수퍼키
3. 후보키 ( 대체키 ( 수퍼키
4. 수퍼키 ( 후보키 ( 대체키

- 2번
