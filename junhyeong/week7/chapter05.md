# 7주차 🛅데이터베이스

## Chap05. 이상 (Anomaly)

### #0. 정규화

#### 개념

- 데이터 중복을 최소화하고, 데이터 무결성을 유지하기위해 테이블 구조를 체계적으로 설계하는 과정
- 한 테이블에 하나의 개념만 담도록 함

#### 특징

- 데이터 중복을 최소화: 동일한 정보 반복 저장되는 문제 방지
- 데이터 무결성 유지: 한곳의 변경이 전체에도 일관됨
- 이상현상을 방지: 삽입/삭제/갱신 이상 방지
- 데이터 구조 단순화
- 데이터 종속성 정리: 부분/이행적 종속 제거

#### 단계

- 1정규형 (1NF)

  - 개념: 모든 속성은 원자값을 가짐

  - 예시

    - 1정규형 만족 X
      |학번|이름|학과명|수강과목|지도교수|
      |:--:|:--:|:--:|:--:|:--:|
      |1|박준형|컴퓨터공학과|데이터베이스, 운영체제|김교수|
      |2|홍길동|클라우드공학과|네트워크|최교수|

    - 1정규형 만족 O  
      |학번|이름|학과명|수강과목|지도교수|
      |:--:|:--:|:--:|:--:|:--:|
      |1|박준형|컴퓨터공학과|데이터베이스|김교수|
      |1|박준형|컴퓨터공학과|운영체제|김교수|
      |2|홍길동|클라우드공학과|네트워크|최교수|

- 2정규형 (2NF)

  - 개념

    - 부분 함수 종속 제거
    - 부분 함수 종속
      - 기본키가 복합키일 때, 기본키 전체가 아닌 일부 속성에 의해 다른 속성이 종속되는 경우
      - 예시: 기본키가 (학번, 과목코드)인 테이블에서 과목명은 과목코드에만 의존함(부분적으로 종속됨)

  - 예시

    - 2정규형 만족 O (학생 테이블과 수강 테이블로 분리)
      |학번|이름|학과명|지도교수|
      |:--:|:--:|:--:|:--:|
      |1|박준형|컴퓨터공학과|김교수|
      |2|홍길동|클라우드공학과|최교수|

      | 학번 |   수강과목   |
      | :--: | :----------: |
      |  1   | 데이터베이스 |
      |  1   |   운영체제   |
      |  2   |   네트워크   |

- 3정규형 (3NF)

  - 개념
    - 이행 함수 종속 제거
    - 이행 함수 종속 (A, B, C는 속성)
      - A → B이고 B → C이면, A → C가 성립하는 관계
      - C가 A에 이행적으로 종속되어 있음
    - 기본키가 아닌 속성이 또 다른 속성에 종속되어 있으면 분리
  - 예시

    - 3정규형 만족 O (학생 테이블, 학과 테이블, 수강 테이블로 분리)

      | 학번 |  이름  |      학과      |
      | :--: | :----: | :------------: |
      |  1   | 박준형 |  컴퓨터공학과  |
      |  2   | 홍길동 | 클라우드공학과 |

      | 학과ID |     학과명     | 지도교수 |
      | :----: | :------------: | :------: |
      |   A1   |  컴퓨터공학과  |  김교수  |
      |   B1   | 클라우드공학과 |  최교수  |

      | 학번 |   수강과목   |
      | :--: | :----------: |
      |  1   | 데이터베이스 |
      |  1   |   운영체제   |
      |  2   |   네트워크   |

- 보이스-코드 정규형 (BCNF)
  - 개념
    - 모든 결정자가 후보키여야 함
    - 즉, 비후보키가 결정자가 되는 상황을 비허용
    - 이상 현상을 효과적으로 방지
  - 예시
    - 예시
      - 속성이 (학번, 이름, 지도교수, 강의실)이고, 기본키가 (학번)일 때, 지도교수가 강의실을 결정할 수 있음
      - 이 때, 지도교수는 기본키가 아니므로 BCNF 위반
      - 지도교수와 강의실을 정보를 담는 테이블로 분리

---

### #1. 이상 현상 (Anomaly)

#### 개념

- 데이터베이스 정규화가 제대로 이루어지지 않았을 때 발생하는 데이터 무결성 문제
- 테이블 설계가 잘못되어 데이터 삽입/삭제/갱신 시 문제가 발생함
- 데이터가 중복으로 저장되어 있거나 비정상적으로 종속되어 있는 경우

#### 종류

1. 삽입 이상 (Insertion Anomaly)
   - 개념: 새로운 데이터 삽입 시, 불필요한 데이터가 입력되거나 필요한 데이터를 삽입하지 못하는 문제
   - 예시
     - 해당 테이블의 기본 키는 학번임
     - 클라우드공학과를 새로 개설하려는데 아직 등록된 학생이 없어 삽입을 못함
2. 삭제 이상 (Deletion Anomaly)
   - 개념: 데이터를 삭제할 때 의도하지 않은 정보도 같이 삭제되는 문제
   - 예시
     - 컴퓨터공학과에 한명의 학생만 소속되어있는데, 해당 학생을 삭제하면서 컴퓨터공학과에 대한 정보도 함께 삭제됨
     - 비정규화 테이블인 상황임을 인지하면서 이해하기
3. 갱신 이상 (Update Anomaly)
   - 개념: 데이터 수정 시, 모든 데이터를 일괄로 수정하지 않으면 데이터 불일치가 발생하는 문제
   - 예시
     - 학생 테이블의 컬럼에 학과 전화번호가 있는 경우
     - 컴퓨터공학과의 전화번호가 변경되어, 수정하는 경우 그 컴퓨터공학과에 속한 모든 학생들의 컬럼을 수정해야함

#### 제1정규형에서 발생하는 이상현상

| 학번 |  이름  |     학과명     |   수강과목   | 지도교수 |
| :--: | :----: | :------------: | :----------: | :------: |
|  1   | 박준형 |  컴퓨터공학과  | 데이터베이스 |  김교수  |
|  1   | 박준형 |  컴퓨터공학과  |   운영체제   |  김교수  |
|  2   | 홍길동 | 클라우드공학과 |   네트워크   |  최교수  |

- 삽입 이상: 수강과목이 없는 학생은 삽입이 불가능
- 삭제 이상: 네트워크 과목 삭제 시 홍길동 학생까지 사라짐
- 갱신 이상: 학생의 학과 수정 시 여러 행을 수정해야 함

#### 제2정규형에서 발생하는 이상현상

| 학번 |  이름  |     학과명     | 지도교수 |
| :--: | :----: | :------------: | :------: |
|  1   | 박준형 |  컴퓨터공학과  |  김교수  |
|  2   | 홍길동 | 클라우드공학과 |  최교수  |

| 학번 |   수강과목   |
| :--: | :----------: |
|  1   | 데이터베이스 |
|  1   |   운영체제   |
|  2   |   네트워크   |

- 삽입 이상: 새 학과 추가 시 학생이 필요함
- 삭제 이상: 특정 학과 학생이 모두 삭제되면 학과, 교수 정보도 사라짐
- 갱신 이상: 한 학과의 지도교수 변경 시, 해당 학과 소속 학생 전부 수정해야함

#### 제3정규형에서 발생하는 이상현상

| 학번 |  이름  |      학과      |
| :--: | :----: | :------------: |
|  1   | 박준형 |  컴퓨터공학과  |
|  2   | 홍길동 | 클라우드공학과 |

| 학과ID |     학과명     | 지도교수 |
| :----: | :------------: | :------: |
|   A1   |  컴퓨터공학과  |  김교수  |
|   B1   | 클라우드공학과 |  최교수  |

| 학번 |   수강과목   |
| :--: | :----------: |
|  1   | 데이터베이스 |
|  1   |   운영체제   |
|  2   |   네트워크   |

- 없음

---

### 퀴즈

#### 1번. 제3정규형에서는 이상현상이 발생하지 않는다. (O/X 퀴즈)

- X

#### 2번. 이상 현상 방지 방법으로 가장 적절한 것은?

1. 테이블을 여러개로 나누어 관계를 설정
2. 테이블의 컬럼 수를 늘림
3. 데이터 중복을 허용
4. 인덱스 생성 최소화

- 1번
