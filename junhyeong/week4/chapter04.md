# π–²οΈμ΄μμ²΄μ  4μ£Όμ°¨

## Chap04. μΈν„°λ½νΈ (Interrupt)

### #0. CPUμ™€ I/Oμ¥μΉ κ°„μ μ΄λ²¤νΈ μ²λ¦¬ λ°©μ‹

#### 0. μ΄λ²¤νΈμ μμ‹

1. μ…μ¶λ ¥ μ‘μ—… μ™„λ£ : λ””μ¤ν¬μ—μ„ νμΌμ„ μ½κ±°λ‚ μ“Έλ•, λ°μ΄ν„° μ „μ†΅μ΄ λλ‚  λ•
2. μ‚¬μ©μ μ…λ ¥ : μ‚¬μ©μκ°€ μ…λ ¥μ¥μΉ(ν‚¤λ³΄λ“, λ§μ°μ¤ λ“±)μ— actionμ„ μ·¨ν•  λ•
3. μ¥μΉ μƒνƒ λ³€ν™” : ν”„λ¦°ν„°κ°€ μΈμ‡„λ¥Ό λλƒμ„ λ•, λ„¤νΈμ›ν¬ μΉ΄λ“κ°€ ν¨ν‚· μμ‹ μ„ μ™„λ£ν–μ„ λ• λ“±
4. νƒ€μ΄λ¨Έ μ•λ¦Ό : μΌμ • μ‹κ°„μ΄ κ²½κ³Όν–μ„ λ•
5. μ¤λ¥ λ°μƒ : μ¥μΉμ— μ—λ¬κ°€ λ°μƒν–μ„ λ•

#### 1. ν΄λ§(Polling) λ°©μ‹

- κ°λ… : CPUκ°€ μ£ΌκΈ°μ μΌλ΅ I/Oμ¥μΉμ μƒνƒλ¥Ό μ§μ ‘ ν™•μΈν•μ—¬ μ΄λ²¤νΈ λ°μƒμ—¬λ¶€λ¥Ό ν™•μΈν•λ” λ°©μ‹
- νΉμ§•
  - κµ¬ν„ μ‰¬μ›€. μ°μ„ μμ„ λ³€κ²½ μ©μ΄ (μ΄μμ²΄μ , μ•± λ“±μ—μ„ μ½”λ“λ¥Ό μμ •)
  - μ§€μ†μ μΈ κ°μ‹λ΅ μ‹μ¤ν… μμ›μ„ λ§μ΄ μ†λ¨
  - μ΄λ²¤νΈ λ°μƒ μ§€μ μ— μ¦‰κ°μ μΌλ΅ λ°μ‘ λ»ν•  μ μμ.

#### 2. μΈν„°λ½νΈ(Intertupt) λ°©μ‹

- κ°λ…
  - I/Oμ¥μΉμ—μ„ μ΄λ²¤νΈ λ°μƒ μ‹ CPUμ— μ§μ ‘ μ‹ νΈλ¥Ό λ³΄λ‚΄ μ¦‰μ‹ μ²λ¦¬ν•λ„λ΅ μ”μ²­ν•λ” λ°©μ‹
  - μ…μ¶λ ¥ κ΄€λ¦¬μκ°€ μ…μ¶λ ¥μ„ λ€μ‹  ν•΄μ£Όλ” λ°©μ‹
- νΉμ§•

  - κµ¬ν„μ΄ μƒλ€μ μΌλ΅ λ³µμ΅ν•¨.
  - μ‹μ¤ν… λ¶€ν•κ°€ μƒλ€μ μΌλ΅ μ μ.
  - μ΄λ²¤νΈ λ°μƒν• μκ°„μ— λ°μ‘μ΄ λΉ λ¦„.
  - CPUλ¥Ό ν¨μ¨μ μΌλ΅ μ‚¬μ©κ°€λ¥ (μ΄λ²¤νΈ λ°μƒ μ‹μ μ—λ§ κ°μ…ν•λ―€λ΅.)

---

### #1. μΈν„°λ½νΈ κ΄€λ ¨ μ©μ–΄

- **μΈν„°λ½νΈ**

  - κ°λ… : CPUκ°€ λ…λ Ήμ„ μν–‰ν•λ” λ„μ¤‘ μ΄λ²¤νΈκ°€ λ°μƒν–μ„ λ•, μ‘μ—…μ„ μ¤‘λ‹¨ν•κ³  μ΄λ²¤νΈλ¥Ό μ°μ„ μ μΌλ΅ μ²λ¦¬ν•λ„λ΅ ν•λ” **μ‹ νΈ**

- **μΈν„°λ½νΈ λ²νΈ** (IRQ - Interrupt ReQuest)

  - κ°λ…
    - λ°μƒν• μΈν„°λ½νΈμ μΆ…λ¥λ¥Ό μ‹λ³„ν•κΈ° μ„ν• μ«μ(μ½”λ“)
    - μΈν„°λ½νΈ λ§λ‹¤ κ³ μ  λ²νΈκ°€ λ¶€μ—¬λμ–΄ μμ.
    - CPU/μ΄μμ²΄μ λ” μΈν„°λ½νΈ λ²νΈλ¥Ό κΈ°μ¤€μΌλ΅ μ–΄λ–¤ μ²λ¦¬κ°€ ν•„μ”ν•μ§€ κ²°μ •

- **μΈν„°λ½νΈ λ²΅ν„°** (Interrupt Vector)

  - κ°λ…
    - IRQμ— λ”°λΌ μ‹¤ν–‰ν•  ISRμ μ£Όμ†
    - μΈν„°λ½νΈ λ§λ‹¤ ν•΄λ‹Ή μΈν„°λ½νΈ μ²λ¦¬ λ£¨ν‹΄μΌλ΅ μ§„μ…ν•λ” μ£Όμ†μ •λ³΄

- **μΈν„°λ½νΈ λ²΅ν„° ν…μ΄λΈ”**

  - κ°λ…
    - μΈν„°λ½νΈ λ²΅ν„°(μ£Όμ†)λ¥Ό ν•κ³³μ— λ¨μ•„λ‘” ν…μ΄λΈ” ν•νƒμ μλ£κµ¬μ΅°
    - μΈν„°λ½νΈ λ²΅ν„°λ“¤μ μ§‘ν•©

- **μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄** (ISR - Interrupt Service Routine = μΈν„°λ½νΈ ν•Έλ“¤λ¬)

  - κ°λ… : μΈν„°λ½νΈ μ‹ νΈλ¥Ό μ²λ¦¬ν•κΈ° μ„ν•΄ CPUκ°€ μ‹¤ν–‰ν•λ” ν•¨μ νΉμ€ μ½”λ“λΈ”λ΅

- **μ¤‘μ²© μΈν„°λ½νΈ** (Nested Interrupt)
  - κ°λ… : ISRμ„ μ‹¤ν–‰ν•κ³  μλ” λ„μ¤‘μ— λ” λ†’μ€ μ°μ„ μμ„μ μΈν„°λ½νΈκ°€ λ°μƒν•λ©΄, ν„μ¬ ISRμ„ μΌμ‹ μ¤‘λ‹¨ν•κ³  μƒλ΅μ΄ ISR(λ” λ†’μ€ μ°μ„ μμ„)μ„ λ¨Όμ € μ²λ¦¬ν•λ” κ²ƒμ„ μλ―Έ
- **μ…μ¶λ ¥ κ΄€λ¦¬μ** (I/O Manager)

  - κ°λ… : CPUμ™€ I/Oμ¥μΉ κ°„μ μ…μ¶λ ¥ μ‘μ—…μ„ ν¨μ¨μ μ΄κ³  μ•μ „ν•κ² κ΄€λ¦¬/μ¤‘μ¬ν•λ” λ‹΄λ‹Ήν•λ” μ΄μμ²΄μ μ κµ¬μ„±μ”μ†
  - νΉμ§•
    1. μ΄μμ²΄μ μ μ»¤λ„μμ—­μ— κµ¬ν„λμ–΄μμ.
    2. CPUκ°€ λ‚΄λ¦° μ…μ¶λ ¥ μ‘μ—… λ…λ Ήμ„ μν–‰ν•κ³ , μ™„λ£ μ‹ CPUμ— μΈν„°λ½νΈ μ‹ νΈλ¥Ό λ³΄λ‚΄ μ•λ ¤μ¤.
    3. μ™Έλ¶€ μΈν„°λ½νΈμ—μ„ λ™μ‘ν•¨.

- **μ§μ ‘ λ©”λ¨λ¦¬ μ ‘κ·Ό** (DMA - Direct Memory Access)
  - κ°λ… : μ…μ¶λ ¥ κ΄€λ¦¬μκ°€ CPUκ°€ μ”μ²­ν• λ°μ΄ν„°λ¥Ό λ©”λ¨λ¦¬μ— κ°€μ Έλ‹¤ λ†“μ„ λ•, CPUμ ν—λ½ μ—†μ΄ λ©”λ¨λ¦¬μ— μ ‘κ·Όν•  μ μλ” κ¶ν•
  - μ‚¬μ΄ν΄ ν›”μΉκΈ° (Cycle Stealing) : CPUμ™€ DMAκ°€ λ™μ‹μ— λ©”λ¨λ¦¬μ— μ ‘κ·Όν•  λ•, DMAκ°€ CPUλ³΄λ‹¤ μ°μ„ μ μΌλ΅ λ©”λ¨λ¦¬μ— μ ‘κ·Όν•λ” μƒν™© (DMAκ°€ λ” λλ¦¬λ―€λ΅.)

---

### #2. μΈν„°λ½νΈμ μΆ…λ¥

#### 1. μ™Έλ¶€ μΈν„°λ½νΈ (External Interrupt = Hardware Interrupt)

- κ°λ… : μ»΄ν“¨ν„° μ‹μ¤ν… μ™Έλ¶€μ ν•λ“μ›¨μ–΄ μ¥μΉκ°€ λ°μƒμ‹ν‚¤λ” μΈν„°λ½νΈ
- μμ‹ : ν‚¤λ³΄λ“ μ…λ ¥, λ§μ°μ¤ ν΄λ¦½, νƒ€μ΄λ¨Έ μ•λ¦Ό, λ””μ¤ν¬ μ…μ¶λ ¥ μ™„λ£ λ“±
- νΉμ§•
  - λΉ„λ™κΈ°μ  : CPUκ°€ μ–Έμ  μ–΄λ–»κ² μ΄λ²¤νΈκ°€ λ°μƒν•λ”μ§€ μ• μ μ—†μ. λ…λ Ήμ–΄(ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ νλ¦„)μ™€ λ¬΄κ΄€.
  - μ…μ¶λ ¥(I/O)μ¥μΉλ‚ μ™Έλ¶€ μ΄λ²¤νΈμ— μν•΄ λ°μƒ
  - μ…μ¶λ ¥ κ΄€λ¦¬μλ¥Ό ν†µν•΄ μΈν„°λ½νΈλ¥Ό μ²λ¦¬ν•λ―€λ΅, μΈν„°λ½νΈ μ²λ¦¬ μ¤‘ λ‹¤λ¥Έ λ™μ‘ μν–‰ κ°€λ¥.

#### 2. λ‚΄λ¶€ μΈν„°λ½νΈ (Internal Interrupt = Exception)

- κ°λ…
  - CPU λ‚΄λ¶€μ—μ„ λ…λ Ήμ–΄ μ‹¤ν–‰ μ¤‘ λ°μƒν•λ” μμ™Έμƒν™©μ— μν• μΈν„°λ½νΈ
  - μλ»λ λ…λ Ή/λ°μ΄ν„° μ‚¬μ© μ‹ λ°μƒ
- μμ‹ : 0μΌλ΅ λ‚λ„κΈ°(κ³„μ‚°μ΄ μ•λλ―€λ΅), μ¤λ²„ν”λ΅μ°, μλ»λ λ…λ Ήμ–΄ μ‹¤ν–‰ λ“±
- νΉμ§•
  - λ™κΈ°μ  : ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ νλ¦„κ³Ό μ—°κ΄€. λ…λ Ήμ–΄ μ‹¤ν–‰κ²°κ³Όμ— λ”°λΌ λ°μƒ.
  - μ¤λ¥λ‚ μμ™Έμƒν™© λ°μƒ μ‹ CPUκ°€ μλ™μΌλ΅ λ°μƒμ‹ν‚΄.
  - CPU λ‚΄λ¶€μ—μ„ μ²λ¦¬ν•λ” μΈν„°λ½νΈμ΄λ―€λ΅, μ²λ¦¬ μ¤‘ λ‹¤λ¥Έ λ™μ‘ μν–‰ λ¶κ°€λ¥
- μ ν•
  1. νΈλ©(Trap)
     - μλ―Έ : ν”„λ΅κ·Έλλ¨Έκ°€ μλ„μ μΌλ΅ λ°μƒμ‹ν‚¤λ” μμ™Έλ΅ μΈν• μΈν„°λ½νΈ
     - νΉμ§• : μ •μƒ μ μ–΄ νλ¦„μ μΌλ¶€. λ‹¤μ λ…λ Ήμ–΄λ΅ λ³µκ·€. μ‚¬μ©μμ μλ„ν• λ™μ‘.
     - μμ‹ : μ‹μ¤ν… μ½, Breakpoint νΈλ© λ“±
  2. ν΄νΈ(Fault)
     - μλ―Έ : ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ μ¤‘ μ¤λ¥μƒν™©μ΄ λ°μƒν• κ²½μ°. λ³µκµ¬κ°€ κ°€λ¥ν• μ μ •μ  μ—λ¬.
     - νΉμ§• : μμ™Έκ°€ λ°μƒν• λ…λ Ήμ–΄λ¥Ό μ¬μ‹¤ν–‰ κ°€λ¥. μ΄μμ²΄μ κ°€ λ¬Έμ  ν•΄κ²°μ‹ μ΄μ–΄μ„ μ‹¤ν–‰ κ°€λ¥.
     - μμ‹ : 0μΌλ΅ λ‚λ„κΈ°, νμ΄μ§€ ν΄νΈ, μ„Έκ·Έλ¨Όν…μ΄μ… ν΄νΈ λ“±
  3. μ–΄λ³΄νΈ(Abort) : λ³µκµ¬ λ¶κ°€λ¥ν• μ‹¬κ°ν• μ¤λ¥, ν”„λ΅κ·Έλ¨ κ°•μ  μΆ…λ£

#### 3. μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ (Software Interrupt)

- κ°λ…
  - ν”„λ΅κ·Έλ¨μ΄ μ²λ¦¬μ¤‘ λ…λ Ήμ–΄λ¥Ό ν†µν•΄ μλ„μ μΌλ΅ μΈν„°λ½νΈλ¥Ό λ°μƒμ‹ν‚¤λ” λ°©μ‹
  - μ‚¬μ©μκ°€ μ΄μμ²΄μ  μ„λΉ„μ¤λ¥Ό μ”μ²­ OR ν”„λ΅κ·Έλλ¨Έκ°€ μ½”λ“μƒμ—μ„ νΈμ¶
- μμ‹ : μ‹μ¤ν… μ½, λ””λ²„κΉ… λ©μ μ μ¤‘λ‹¨ λ“±
- νΉμ§•
  - λ™κΈ°μ 
  - μ†ν”„νΈμ›¨μ–΄ λ…λ Ήμ–΄μ— μν•΄ λ°μƒ
  - μ΄μμ²΄μ  μ„λΈ νΈμ¶ λ“±μ— μ‚¬μ©λ¨.

---

### #3. μΈν„°λ½νΈ λ°μƒ μ²λ¦¬ κ³Όμ •

#### μΈν„°λ½νΈ λ°μƒ μ²λ¦¬ κ³Όμ •

1. μΈν„°λ½νΈ μ‹ νΈ κ°μ§€
2. ν„μ¬ μ‘μ—… μ¤‘λ‹¨ : μν–‰μ¤‘μΈ μ‘μ—…μ μƒνƒλ¥Ό CPUμ μ¤νƒμμ—­μ— μ €μ¥ (λ³µμ›μ΄ κ°€λ¥ν•λ„λ΅)
3. μΈν„°λ½νΈ μ°μ„ μμ„ ν™•μΈ

   - μ—¬λ¬κ°μ μΈν„°λ½νΈμ μ°μ„ μμ„λ¥Ό μ •ν•λ” μƒν™©
   - νΉμ€ ν„μ¬ μν–‰μ¤‘μΈ λ…λ Ήμ–΄μ™€ μΈν„°λ½νΈ μ¤‘ μ°μ„ μμ„λ¥Ό νλ‹¨ν•λ” μƒν™©

4. μΈν„°λ½νΈ λ²΅ν„° ν™•μΈ : μΈν„°λ½νΈ λ²΅ν„° ν…μ΄λΈ”μ—μ„ ν•΄λ‹Ή μΈν„°λ½νΈμ— ν•΄λ‹Ήν•λ” ISR ν™•μΈ
5. μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄ μ‹¤ν–‰ : ISRλ΅ μ ν”„. μ΄λ²¤νΈ μ²λ¦¬.
6. μƒνƒ λ³µμ› λ° λ³µκ·€ : ISR μΆ…λ£. μ›λ μ‘μ—… λ³µμ› λ° λ³µκ·€.

![μΈν„°λ½νΈκ³Όμ •](./assets/μΈν„°λ½νΈκ³Όμ •λ§ν‚Ή.png)

---

### #4. ν€΄μ¦

#### 1λ² : λ‹¤μ μ¤‘ λ‚΄λ¶€ μΈν„°λ½νΈμ— ν•΄λ‹Ήν•μ§€ μ•λ” κ²ƒμ€?

    1. 0 λ‚λ„κΈ°
    2. μ¤λ²„ν”λ΅μ°
    3. μ‹μ¤ν… μ½
    4. μ…μ¶λ ¥ μ¤€λΉ„ μ™„λ£

#### 2λ² : μ¤‘μ²© μΈν„°λ½νΈκ°€ λ°μƒν•λ‹¤λ©΄ μ„μ μ΄λ―Έμ§€μ μ–΄λ λ¶€λ¶„μ—μ„ λ°μƒν•λ”κ°€?

    (1) (2) (3) (4) (5) (6)

#### 3λ² : μ…μ¶λ ¥μ¥μΉλ” DMAλ¥Ό ν†µν•΄ λ©”λ¨λ¦¬λ¥Ό μ‚¬μ©ν•  μ μλ‹¤. μ‚¬μ΄ν΄ ν›”μΉκΈ°λ” DMAκ°€ CPUλ³΄λ‹¤ μ°μ„ μ μΌλ΅ λ©”λ¨λ¦¬μ— μ ‘κ·Όν•λ” μƒν™©μ„ μλ―Έν•λ”λ°, μ΄λ” CPUμ μ‘μ—… μ†λ„λ³΄λ‹¤ μ…μ¶λ ¥ μ¥μΉμ μ†λ„κ°€ λ” λλ¦¬κΈ° λ•λ¬Έμ΄λ‹¤. μ΄λ ‡κ² μ„¤κ³„ν• μ΄μ λ” λ¬΄μ—‡μΌκΉ?

- CPU ν¨μ¨μ„±μ΄ ν–¥μƒλ¨ : μ™Έλ¶€ μΈν„°λ½νΈλ” μ…μ¶λ ¥ κ΄€λ¦¬μμ μ—­ν• μ΄ μν–‰λ¨μΌλ΅μ¨ μ΄λ¤„μ§„λ‹¤. ν•μ§€λ§, CPUμ μ°μ„ μμ„κ°€ λ” λ†’μ„ κ²½μ° μ…μ¶λ ¥ μ‘μ—…μ κ²°κ³Όκ°€ μ§€μ—°λλ©΄μ„ CPUμ ν¨μ¨μ„± μ—­μ‹ λ–¨μ–΄μ§€κ² λλ‹¤. λ”°λΌμ„ DMAμ μ°μ„ μμ„κ°€ λ” λ†’μ•„μ•Ό μ™Έλ¶€ μΈν„°λ½νΈκ°€ μ›ν™ν•κ² μ§„ν–‰λ  κ²ƒμ΄κ³ , μ΄λ” CPUμ ν¨μ¨μ„± ν–¥μƒμΌλ΅ μ΄μ–΄μ§„λ‹¤.
- μ…μ¶λ ¥ μ¥μΉμ μ•„μ‚¬ν„μƒμ„ λ°©μ§€ν•κΈ° μ„ν•¨ : CPUμ μ°μ„ μμ„κ°€ λ” λ†’μ€ κ²½μ° (DMAμ μ°μ„ μμ„λ¥Ό λ†’μ—¬μ£Όμ§€ μ•μ€ κ²½μ°), CPUκ°€ κ³„μ†ν•΄μ„ λ©”λ¨λ¦¬ λ²„μ¤λ¥Ό κ³„μ†ν•΄μ„ μ μ ν•κ² λκ³ , μ΄λ” μ…μ¶λ ¥ μ‘μ—…μ΄ μ§€μ—°λκ±°λ‚ μ‹¤ν¨ν•λ” μƒν™©μΌλ΅ μ΄μ–΄μ§ μ μλ‹¤.
