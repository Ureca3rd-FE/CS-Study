# 🖲️운영체제 5주차

## Chap06. PCB & Context Switching

### #1. 프로세스 관리 - Process Management

#### 개념 : 운영체제에서 프로세스의 생성, 실행, 종료 등 전체 생명주기를 효율적으로 관리하는 기능

#### 종류

1. 프로세스 생성 및 종료

   - 생성
     - 새로운 프로세스를 생성하기 위한 시스템 호출(fork(), exec())을 제공함
     - 생성 과정을 통해 메모리 할당, PCB 생성, 준비 큐 등록 등의 절차가 진행됨.
   - 종료
     - 프로세스가 작업을 마치거나 오류가 발생하면 종료시키기 위한 시스템 호출(exit())을 제공함
     - 사용하던 자원이 운영체제로 반환됨
     - 부모 프로세스는 wait() 시스템 호출을 통해 자식 프로세스의 종료상태를 받아옴

2. 프로세스 자원 할당 및 보호
   - 자원 할당 : 각 프로세스에 CPU, 메모리 등 필요한 자원을 적절히 분배해줌
   - 보호 : 프로세스의 자원(메모리 공간, 파일 등)를 다른 프로세스, 악의적 코드, 시스템 침입, 사용자의 부적절한 접근 등으로 부터 보호함
3. 프로세스 상태 및 전환 관리
   - 프로세스의 다양한 상태를 준비큐/대기큐를 활용하여 상태 전환을 관리함
   - 프로세스의 상태는 준비, 실행, 대기, 종료 등이 있음
   - 각 상태는 PCB에 기록됨
4. CPU 스케줄링
   - 여러 프로세스에게 CPU시간을 어떻게 나눌지 결정하는 기능
   - 다양한 스케줄링 알고리즘이 존재
5. 프로세스 동기화 및 통신관리
   - 여러 프로세스가 자원공유/협력작업을 할 때 동기화, 통신이 필요함
   - 운영체제는 동기화 제어, 교착상태 방지 기능을 통해 안정적인 환경을 제공

---

### #2. 프로세스 제어 블록 (PCB - Process Control Block)

#### 개념

- 프로그램이 프로세스로 전환될 때 운영체제가 만드는 작업지시서
- 운영체제가 각 프로세스를 관리하기 위해 정의한 자료구조 (데이터 구조체)

#### 특징

- 프로세스 메타데이터(Process Metadata), 프로세스 주소 공간에 대한 정보(위치, 크기 등)이 저장되는 곳
- 프로세스가 생성 시 생성, 완료 시 제거됨
- 프로세스가 생성될 때마다 해당 PCB가 생성되고, 이 PCB들은 주소값을 통해 연결 리스트 형태로 관리됨

#### PCB의 구성

| 구성               | 의미                                                                   |
| :----------------- | :--------------------------------------------------------------------- |
| 포인터             | 대기상태의 프로세스들을 연결리스트로 관리할때 프로세스를 가리키는 역할 |
| 프로세스 상태      | 생성, 준비, 실행, 대기, 보류 등의 상태를 저장                          |
| 프로세스 구분자    | 프로세스를 구분하기 위한 ID                                            |
| 프로그램 카운터    | 다음에 실행될 명령어의 위치값                                          |
| 프로세스 우선순위  | 실행순서를 결정하는 우선순위                                           |
| 각종 레지스터 정보 | 실행되는 중에 사용하던 레지스터 값                                     |
| 메모리 관리 정보   | 프로세스의 메모리 위치 정보, 경계 레지스터/한계 레지스터 값            |
| 할당된 자원 정보   | 입출력 자원, 오픈 파일 등에 대한 정보                                  |
| 계정 정보          | 계정 번호, CPU 할당 시간 등                                            |
| PPID, CPID         | 부모 프로세스 식별자, 자식 프로세스 식별자                             |

---

### #3. 문맥 교환 - Context Switching

#### 개념

- 실행 중인 프로세스의 상태(문맥)을 PCB에 저장하고, 다음에 실행할 프로세스의 PCB에서 상태 정보를 복원하여 CPU에 할당하는 작업
- 문맥을 PCB에 저장함으로써 프로세스가 다시 시작할 때, 중단된 지점부터 실행이 가능함

#### 특징

- 멀티태스킹의 실현
  - 멀티태스킹의 시분할 시스템을 실현하는 메커니즘
  - 여러 프로세스가 번갈아가며 CPU를 사용하여 동시에 실행되는 것처럼 보이게함
- 오버헤드 발생
  - 문맥교환 과정에서는 작업이 진행되지 않음
  - 이는 시스템 자원을 실제 작업이 아닌 상황에 소모되는 상황임
  - 문맥교환이 잦을 경우 성능 저하 일어남
- 발생 시점
  - 실행 -> 준비 : 현재 프로세스가 CPU를 빼앗길 때 (타임 슬라이스 종료, 인터럽트)
  - 실행 -> 대기 : 입출력 요청, 시그널 대기 등으로 프로세스가 자발적으로 CPU를 반납할 때
  - 대기 -> 준비 : 입출력 완료 등으로 대기 상태의 프로세스가 준비 상태로 진입할 때
  - 준비 -> 실행 : 스케줄러에 의해 실행 상태로 전활될 때
