# 세마포어(Semaphore)&뮤텍스(Mutex)
공유된 자원에 여러 프로세스가 동시 접근하면서 문제가 발생할 수 있음.
↓
공유된 자원의 데이터는 한 번에 하나의 프로세스만 접근할 수 있도록 제한 필요.

그걸 위해 **멀티 프로그래밍 환경에서 공유 자원에 접근을 제한하는 방법**으로 나온 게 `세마포어`.

### 임계 구역(Critical Section)
여러 프로세스가 데이터를 공유하며 수행될 때, **각 프로세스에서 공유 데이터를 접근하는 프로그램 코드 부분**

공유 데이터를 여러 프로세스가 동시 접근할 때 잘못된 결과를 만들 수 있기 때문에, 한 프로세스가 임계 구역을 수행할 땐 다른 프로세스의 접근을 막아야 한다.

## 세마포어 P, V 연산
- P: 임계 구역 들어가기 전에 수행
- V: 임계 구역에서 나올 때 수행
```
procedure P(S)
    while S=0 do wait
    S:=S-1
end P
// S가 0이면 1이 될 때까지(빈 자리가 날 때까지) 대기
// P를 동작시키면 S 자리를 차지하여 다른 프로세스가 못 들어오도록 함
--- 임계 구역 Critical Section ---
procedure V(S)
    S:=S+1
end V
// 임계 구역 처리가 끝나면 V를 동작해 S 자리를 내어줌
```

## 뮤텍스
임계 구역을 가진 스레드들의 실행 시간이 서로 겹치지 않고 각각 단독으로 실행되게 하는 기술. (상호 배제(Mutual Exclusion)의 약자임)

접근 조율을 위해 lock과 unlock을 사용.
- lock: 임계 구역에 들어갈 때 권한을 얻어옴(다른 프로세스/스레드가 임계 구역 수행 중이면 종료할 때까지 대기)
- unlock: 현재 임계 구역을 모두 사용했다고 알림(다른 프로세스/스레드가 임계 구역에 진입 가능)

뮤텍스는 상태가 0, 1로 `이진 세마포어`라 부르기도 함

## 뮤텍스 알고리즘
사실 이것들은 소프트웨어적 해결법이지 운영체제적 해결법은 아니기 때문에 뮤텍스가 아니지만... 뮤텍스를 소프트웨어적으로 구현하면 이것들과 같음
### 1. 데커(Dekker) 알고리즘
flag와 turn 변수를 통해 임계 구역에 들어갈 프로세스/스레드를 결정하는 방식
- flag: 프로세스 중 누가 임계영역에 진입할 것인지 나타내는 변수
- turn: 누가 임계구역에 들어갈 차례인지 나타내는 변수

### 2. 피터슨(Peterson) 알고리즘
데커와 유사. 상대방 프로세스/스레드에게 진입 기회를 양보하는 것에 차이가 있음.

### 3. 제과점(Bakery) 알고리즘
여러 프로세스/스레드에 대한 처리가 가능한 알고리즘. 가장 작은 수의 번호표를 가지고 있는 프로세스가 임계 구역에 진입힌다.
